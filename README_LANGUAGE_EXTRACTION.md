# Извлечение языков программирования из HTML

## Описание

Реализована функциональность для извлечения информации о языках программирования из тегов `<code>` **до** конвертации HTML в Markdown. Это позволяет корректно определять языки программирования в блоках кода и передавать эту информацию в итоговый Markdown документ.

## Как это работает

### 1. Извлечение языков в порядке появления

Функция `extractCodeLanguagesInOrder()` обрабатывает HTML контент и:

- Находит все теги `<pre><code>` и одиночные теги `<code>` в порядке их появления
- Извлекает информацию о языке программирования из CSS классов
- Сохраняет языки в массив в том же порядке, в котором они встречаются в HTML

### 2. Поддерживаемые форматы CSS классов

Функция `extractLanguageFromCode()` поддерживает следующие форматы:

- `language-{lang}` - стандартный формат (например, `language-python`)
- `lang-{lang}` - сокращенный формат (например, `lang-js`)
- Прямые названия языков (например, `javascript`, `python`, `go`)
- Комбинированные классы (например, `highlight javascript`)

### 3. Нормализация названий языков

Функция `normalizeLanguageName()` приводит различные варианты названий к стандартным:

- `js`, `javascript`, `ecmascript` → `javascript`
- `py`, `python` → `python`
- `cpp`, `c++`, `cplusplus` → `cpp`
- `cs`, `c#`, `csharp` → `csharp`
- `golang`, `go` → `go`
- И многие другие...

### 4. Применение языков по порядку

Функция `applyLanguagesToMarkdownInOrder()` обрабатывает markdown после конвертации:

- Находит все блоки кода (с языком или без)
- Применяет языки из массива по порядку их появления
- Заменяет неправильные или отсутствующие языки на правильные

## Примеры работы

### Исходный HTML:
```html
<pre><code class="language-go">package main
import "fmt"
func main() {
    fmt.Println("Hello, World!")
}</code></pre>

<pre><code class="highlight javascript">function greet(name) {
    console.log("Hello, " + name + "!");
}</code></pre>

<pre><code class="python">def greet(name):
    print(f"Hello, {name}!")
</code></pre>
```

### Извлеченные языки:
```go
languages := ["go", "javascript", "python"]
```

### Итоговый Markdown:
```markdown
```go
package main
import "fmt"
func main() {
    fmt.Println("Hello, World!")
}
```

```javascript
function greet(name) {
    console.log("Hello, " + name + "!");
}
```

```python
def greet(name):
    print(f"Hello, {name}!")
```
```

## Преимущества нового подхода

1. **Простота**: Используется массив языков вместо сложной карты
2. **Надежность**: Языки назначаются по порядку появления в HTML
3. **Точность**: Не зависит от форматирования кода в markdown
4. **Совместимость**: Работает с различными форматами CSS классов
5. **Нормализация**: Приводит различные варианты названий к стандартным
6. **Обработка ошибок**: Если язык не найден, блок остается без языка

## Алгоритм работы

1. **Сканирование HTML**: Проходим по всем тегам `<code>` в порядке их появления
2. **Извлечение языков**: Анализируем CSS классы для определения языка программирования
3. **Сохранение в массив**: Сохраняем языки в массив в том же порядке
4. **Конвертация в Markdown**: Используем html-to-markdown конвертер
5. **Применение языков**: Проходим по блокам кода в markdown и назначаем языки по порядку

## Тестирование

Для демонстрации работы функциональности запустите:

```bash
go test -v -run TestCodeLanguageMapping
```

Этот тест показывает полный процесс обработки HTML и конвертации в Markdown с правильным определением языков программирования.
